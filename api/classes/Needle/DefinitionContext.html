<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: Needle::DefinitionContext</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">Needle::DefinitionContext</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../files/lib/needle/definition-context_rb.html">
                lib/needle/definition-context.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                Object
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
This class is used by the <a
href="Container.html#M000053">Container#define</a>! and <a
href="Container.html#M000056">Container#namespace</a>! methods to allow an
<tt>instance_eval</tt>&#8216;d block to create new service points simply by
invoking imaginary methods. It is basically an empty shell, with almost all
of the builtin methods removed from it. (This allows services like
&quot;hash&quot; and &quot;print&quot; to be defined, where they would
normally conflict with the Kernel methods of the same name.)
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000094">has_key?</a>&nbsp;&nbsp;
      <a href="#M000086">intercept</a>&nbsp;&nbsp;
      <a href="#M000095">knows_key?</a>&nbsp;&nbsp;
      <a href="#M000096">method_missing</a>&nbsp;&nbsp;
      <a href="#M000087">namespace</a>&nbsp;&nbsp;
      <a href="#M000089">namespace!</a>&nbsp;&nbsp;
      <a href="#M000090">namespace_define</a>&nbsp;&nbsp;
      <a href="#M000088">namespace_define!</a>&nbsp;&nbsp;
      <a href="#M000084">new</a>&nbsp;&nbsp;
      <a href="#M000091">require</a>&nbsp;&nbsp;
      <a href="#M000085">this_container</a>&nbsp;&nbsp;
      <a href="#M000092">use</a>&nbsp;&nbsp;
      <a href="#M000093">use!</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000084" class="method-detail">
        <a name="M000084"></a>

        <div class="method-heading">
          <a href="#M000084" class="method-signature">
          <span class="method-name">new</span><span class="method-args">( container )</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Create a new <a href="DefinitionContext.html">DefinitionContext</a> that
wraps the given container. All operations performed on this context will be
delegated to the container.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000084-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000084-source">
<pre>
    <span class="ruby-comment cmt"># File lib/needle/definition-context.rb, line 41</span>
41:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>( <span class="ruby-identifier">container</span> )
42:       <span class="ruby-ivar">@container</span> = <span class="ruby-identifier">container</span>
43:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000094" class="method-detail">
        <a name="M000094"></a>

        <div class="method-heading">
          <a href="#M000094" class="method-signature">
          <span class="method-name">has_key?</span><span class="method-args">( name )</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Delegates to Container#has_key?.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000094-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000094-source">
<pre>
     <span class="ruby-comment cmt"># File lib/needle/definition-context.rb, line 103</span>
103:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">has_key?</span>( <span class="ruby-identifier">name</span> )
104:       <span class="ruby-ivar">@container</span>.<span class="ruby-identifier">has_key?</span>( <span class="ruby-identifier">name</span> )
105:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000086" class="method-detail">
        <a name="M000086"></a>

        <div class="method-heading">
          <a href="#M000086" class="method-signature">
          <span class="method-name">intercept</span><span class="method-args">( name )</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Delegate to <a href="Container.html#M000060">Container#intercept</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000086-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000086-source">
<pre>
    <span class="ruby-comment cmt"># File lib/needle/definition-context.rb, line 52</span>
52:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">intercept</span>( <span class="ruby-identifier">name</span> )
53:       <span class="ruby-ivar">@container</span>.<span class="ruby-identifier">intercept</span>( <span class="ruby-identifier">name</span> )
54:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000095" class="method-detail">
        <a name="M000095"></a>

        <div class="method-heading">
          <a href="#M000095" class="method-signature">
          <span class="method-name">knows_key?</span><span class="method-args">( name )</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Delegates to Container#knows_key?.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000095-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000095-source">
<pre>
     <span class="ruby-comment cmt"># File lib/needle/definition-context.rb, line 108</span>
108:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">knows_key?</span>( <span class="ruby-identifier">name</span> )
109:       <span class="ruby-ivar">@container</span>.<span class="ruby-identifier">knows_key?</span>( <span class="ruby-identifier">name</span> )
110:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000096" class="method-detail">
        <a name="M000096"></a>

        <div class="method-heading">
          <a href="#M000096" class="method-signature">
          <span class="method-name">method_missing</span><span class="method-args">( sym, *args, &amp;block )</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Any method invocation with no block and no parameters is interpreted to be
a service reference on the wrapped container, and delegates to <a
href="Container.html">Container</a>#[]. If the block is not given but the
args are not empty, a NoMethodError will be raised.
</p>
<p>
If a block is given, this delegates to <a
href="Container.html#M000055">Container#register</a>, leaving all
parameters in place.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000096-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000096-source">
<pre>
     <span class="ruby-comment cmt"># File lib/needle/definition-context.rb, line 119</span>
119:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">method_missing</span>( <span class="ruby-identifier">sym</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span> )
120:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block</span>.<span class="ruby-identifier">nil?</span>
121:         <span class="ruby-ivar">@container</span>.<span class="ruby-identifier">get</span>( <span class="ruby-identifier">sym</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span> )
122:       <span class="ruby-keyword kw">else</span>
123:         <span class="ruby-ivar">@container</span>.<span class="ruby-identifier">register</span>( <span class="ruby-identifier">sym</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span> )
124:       <span class="ruby-keyword kw">end</span>
125:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000087" class="method-detail">
        <a name="M000087"></a>

        <div class="method-heading">
          <a href="#M000087" class="method-signature">
          <span class="method-name">namespace</span><span class="method-args">( *parms, &amp;block )</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Delegate to <a href="Container.html#M000056">Container#namespace</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000087-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000087-source">
<pre>
    <span class="ruby-comment cmt"># File lib/needle/definition-context.rb, line 57</span>
57:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">namespace</span>( <span class="ruby-operator">*</span><span class="ruby-identifier">parms</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span> )
58:       <span class="ruby-ivar">@container</span>.<span class="ruby-identifier">namespace</span>( <span class="ruby-operator">*</span><span class="ruby-identifier">parms</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span> )
59:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000089" class="method-detail">
        <a name="M000089"></a>

        <div class="method-heading">
          <span class="method-name">namespace!</span><span class="method-args">( *parms, &amp;block )</span>
        </div>
      
        <div class="method-description">
          <p>
Alias for <a href="DefinitionContext.html#M000088">namespace_define!</a>
</p>
        </div>
      </div>

      <div id="method-M000090" class="method-detail">
        <a name="M000090"></a>

        <div class="method-heading">
          <a href="#M000090" class="method-signature">
          <span class="method-name">namespace_define</span><span class="method-args">( *parms, &amp;block )</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Delegate to <a href="Container.html#M000053">Container#define</a> on the
new namespace.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000090-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000090-source">
<pre>
    <span class="ruby-comment cmt"># File lib/needle/definition-context.rb, line 69</span>
69:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">namespace_define</span>( <span class="ruby-operator">*</span><span class="ruby-identifier">parms</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span> )
70:       <span class="ruby-ivar">@container</span>.<span class="ruby-identifier">namespace</span>( <span class="ruby-operator">*</span><span class="ruby-identifier">parms</span> ) { <span class="ruby-operator">|</span><span class="ruby-identifier">ns</span><span class="ruby-operator">|</span> <span class="ruby-identifier">ns</span>.<span class="ruby-identifier">define</span>( <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span> ) }
71:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000088" class="method-detail">
        <a name="M000088"></a>

        <div class="method-heading">
          <a href="#M000088" class="method-signature">
          <span class="method-name">namespace_define!</span><span class="method-args">( *parms, &amp;block )</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Delegate to <a
href="Container.html#M000059">Container#namespace_define</a>!.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000088-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000088-source">
<pre>
    <span class="ruby-comment cmt"># File lib/needle/definition-context.rb, line 62</span>
62:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">namespace_define!</span>( <span class="ruby-operator">*</span><span class="ruby-identifier">parms</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span> )
63:       <span class="ruby-ivar">@container</span>.<span class="ruby-identifier">namespace_define!</span>( <span class="ruby-operator">*</span><span class="ruby-identifier">parms</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span> )
64:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000091" class="method-detail">
        <a name="M000091"></a>

        <div class="method-heading">
          <a href="#M000091" class="method-signature">
          <span class="method-name">require</span><span class="method-args">( *parms )</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Delegate to <a href="Container.html#M000068">Container#require</a> on the
current container.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000091-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000091-source">
<pre>
    <span class="ruby-comment cmt"># File lib/needle/definition-context.rb, line 74</span>
74:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">require</span>( <span class="ruby-operator">*</span><span class="ruby-identifier">parms</span> )
75:       <span class="ruby-comment cmt"># this is necessary to work around an rdoc bug...rdoc doesn't like</span>
76:       <span class="ruby-comment cmt"># calling require with a variable number of arguments.</span>
77:       <span class="ruby-ivar">@container</span>.<span class="ruby-identifier">__send__</span>( <span class="ruby-identifier">:require</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">parms</span> )
78:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000085" class="method-detail">
        <a name="M000085"></a>

        <div class="method-heading">
          <a href="#M000085" class="method-signature">
          <span class="method-name">this_container</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
A way to access the container reference being operated on from within the
context.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000085-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000085-source">
<pre>
    <span class="ruby-comment cmt"># File lib/needle/definition-context.rb, line 47</span>
47:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">this_container</span>
48:       <span class="ruby-ivar">@container</span>
49:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000092" class="method-detail">
        <a name="M000092"></a>

        <div class="method-heading">
          <a href="#M000092" class="method-signature">
          <span class="method-name">use</span><span class="method-args">( opts, &amp;block )</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Delegate to <a href="Container.html#M000071">Container#use</a> on the
current container, but yields the definition context instead of the
container.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000092-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000092-source">
<pre>
    <span class="ruby-comment cmt"># File lib/needle/definition-context.rb, line 82</span>
82:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">use</span>( <span class="ruby-identifier">opts</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span> )
83:       <span class="ruby-identifier">use!</span> <span class="ruby-ivar">@container</span>.<span class="ruby-identifier">defaults</span>.<span class="ruby-identifier">merge</span>( <span class="ruby-identifier">opts</span> ), <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>
84:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000093" class="method-detail">
        <a name="M000093"></a>

        <div class="method-heading">
          <a href="#M000093" class="method-signature">
          <span class="method-name">use!</span><span class="method-args">( opts ) {|self| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Delegate to <a href="Container.html#M000071">Container#use</a>! on the
current container, but yields the definition context instead of the
container.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000093-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000093-source">
<pre>
     <span class="ruby-comment cmt"># File lib/needle/definition-context.rb, line 88</span>
 88:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">use!</span>( <span class="ruby-identifier">opts</span> )
 89:       <span class="ruby-identifier">original</span> = <span class="ruby-ivar">@container</span>.<span class="ruby-identifier">use!</span>( <span class="ruby-identifier">opts</span> )
 90: 
 91:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
 92:         <span class="ruby-keyword kw">begin</span>
 93:           <span class="ruby-keyword kw">yield</span> <span class="ruby-keyword kw">self</span>
 94:         <span class="ruby-keyword kw">ensure</span>
 95:           <span class="ruby-ivar">@container</span>.<span class="ruby-identifier">use!</span> <span class="ruby-identifier">original</span>
 96:         <span class="ruby-keyword kw">end</span>
 97:       <span class="ruby-keyword kw">end</span>
 98: 
 99:       <span class="ruby-identifier">original</span>
100:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>